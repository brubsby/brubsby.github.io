<html>
  <head>

  <title>brubsby</title>

  <style>
  body {
    background: #fff;
    font-size: 20px;
    font-family: Courier, monospace;
    color: #000;
  	padding: 2em 3em;
    display: grid;
    grid-template-columns: min-content auto;
    grid-template-rows: 100%;
  }
  div {
  	font-weight: normal;
  }
  ol, li {
    list-style-type: none;
    padding-left: 8px;
  }
  div.head {
    margin: 0;
    font-size: 3em;
    grid-column: 1 / 1;
  }
  div.ascii {
    margin-left: 68px;
    vertical-align: top;
    grid-column: 2 / 2;
  }
  a {
    text-decoration: none;
  }
  </style>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script>
  var canvas, flat_pixel_list, rows, columns;
  var frame_count = 0;
  var get_canvas_index = (columns, x, y) => { return x + y * (columns + 1); };
  var setCharAt = (canvas,index,chr) => {
    var str = canvas.text();
    if(index > str.length-1) return str;
    var new_str = str.substr(0,index) + chr + str.substr(index+1);
    canvas.text(new_str);
  };
  var getCharAt = (canvas,index) => {
    return canvas.text().charAt(index);
  };
  var animations = [
    // . to o random
    () => {
      var x, y, index, tries = 0;
      var max_tries = 10000;
      do {
          x = Math.floor(Math.random() * columns);
          y = Math.floor(Math.random() * rows);
          index = get_canvas_index(columns, x, y);
          tries++;
      }
      while (getCharAt(canvas, index) == "o" && tries < max_tries);
      if (tries >= max_tries) return;
      setCharAt(canvas, index, "o");
      setTimeout(animations[0], 0);
    },
    // random hex wipe
    () => {
      var x = frame_count % columns;
      var y = Math.floor(frame_count / columns);
      var index = get_canvas_index(columns, x, y);
      var random_hex_char = Math.floor(Math.random() * 16).toString(16);
      setCharAt(canvas, index, random_hex_char);
      frame_count++
      setTimeout(animations[1], 0);
    }
  ]
  var animation = animations[Math.floor(Math.random() * animations.length)];

  $(document).ready(function() {
    reset_canvas();

    setTimeout(animation, 100);
  });

  var reset_canvas = function() {
      canvas = $(".ascii");
      var width = canvas.width();
      var height = canvas.height();

      rows = Math.max(1, Math.floor(height / 23));
      columns = Math.max(1, Math.floor(width / 12.003));
      var row_text = ".".repeat(columns);

      canvas.empty();
      for (var i = 0; i < rows; i++) {
        canvas.append(row_text + "\n");
      }
  }


  </script>
  </head>
  <body>
    <div class="menu">
      <div class="head">BRUBSBY</div>
      <ol id="links">
        <li id="twitter"><a href="https://twitter.com/brubsby">TWITTER</a></li>
        <li id="art"><a href="https://twitter.com/search?q=(%23plottertwitter%20OR%20%23generative)%20(from%3Abrubsby)&src=typed_query">ART</a></li>
        <li id="support"><a href="https://ko-fi.com/brubsby">SUPPORT</a></li>
      </ol>
    </div>
    <div class="ascii"></div>
  </body>
</html>
