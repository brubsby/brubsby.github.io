<html>
  <head>
  <link href="assets/favicon.png" rel="icon" data-n-head="true" type="image/png">
  <meta name="title" content="brubsby">
  <meta name="description" content="my website :)">
  <meta name="keywords" content="brubsby, programming, math, computer art">
  <meta name="robots" content="index, follow">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="language" content="English">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">

  <title>brubsby</title>

  <style>

  @font-face {
    font-family: 'DF';
    src: url('assets/LessPerfectDOSVGA.woff') format('woff'), /* Chrome 6+, Firefox 3.6+, IE 9+, Safari 5.1+ */
     url('assets/LessPerfectDOSVGA.ttf') format('truetype'); /* Chrome 4+, Firefox 3.5, Opera 10+, Safari 3â€”5 */
  }

  @media (orientation: landscape) {
    div.ascii {
      grid-area: 1 / 2 / span 2 / span 1;
    }
    div.tooltip {
      grid-area: 2 / 1 / span 1 / span 1;
    }
    span.tooltip {
      bottom: 0;
      left: 0;
      padding-bottom: 1em;
      padding-left: 16px;
      text-align: left;
    }
  }

  @media (orientation: portrait) {
    div.ascii {
      grid-area: 2 / 1 / span 1 / span 2;
    }
    div.tooltip {
      grid-area: 1 / 2 / span 1 / span 1;
    }
    span.tooltip {
      bottom: 0;
      right: 0;
      padding-bottom: 1em;
      padding-right: 16px;
      text-align: right;
    }
  }

  @media (prefers-color-scheme: dark) {
    body {
      background: black;
      color: white;
    }
  }
  @media (prefers-color-scheme: no-preference), (prefers-color-scheme: light) {
    body {
      background: white;
      color: black;
    }
  }

  html {
    overflow: hidden;
  }

  body {
    font-size: 20px;
    font-family: Courier, monospace;
  	padding: 2em 3em 2em 3em;
  }

  div.container {
    display: grid;
    grid-column-gap: 68px;
    grid-row-gap: 10px;
    grid-template-columns: min-content auto;
    grid-template-rows: min-content auto;
    height: 100%;
  }
  div {
  	font-weight: normal;
  }
  ol, li {
    list-style-type: none;
    padding-left: 8px;
  }
  div.menu {
    margin: 0;
    grid-area: 1 / 1 / span 1 / span 1;
  }
  h1 {
    margin: 0;
    font-weight: normal;
    style: none;
    font-size: 3em;
  }
  div.ascii {
    vertical-align: top;
    white-space: pre;
    line-height: 1;
    font-size: 24px;
    font-family: "DF", monospace;
  }
  div.tooltip {
    position: relative;
  }
  span.tooltip {
    position: absolute;
  }
  a {
    text-decoration: none;
    color: inherit;
  }
  li:hover {
    text-decoration: underline;
  }
  </style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-152720878-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-152720878-1');
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.3.10/seedrandom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/6.2.2/math.min.js"></script>
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/gpu.js/1.10.4/gpu.min.js"></script>-->
  <script src="js/simplex-noise.js"></script>
  <script type="module">
  import { ObjectSampler, reset_canvas, getUrlParameter } from './js/utils.js';

  /*----------- Global init -----------*/
  window.canvas = null;
  window.flat_index_list = null;
  window.simplex_noise = null;
  window.rows = 0;
  window.columns = 0;
  window.animation_speed_multiplier = 1;
  window.min_dim = 0;
  window.max_dim = 0;
  window.flat_mapgen_tiles = null;
  window.mapgen_tiles = null;
  window.mapgen_probabilities = null;
  window.falloff_map = null;
  window.velocity_pixels = null;
  window.position_pixels = null;
  window.bounces = 0;
  window.text_to_print = null;
  window.flip = false;
  window.line_points = null;
  window.last_points = null;
  window.empty_half_pixels = null;
  window.browser_info = null;
  window.remaining_particles = 0;
  window.particles = null;
  window.random_edge_point_sampler = null;
  window.active_sand_coords = null;
  window.grid = null;
  window.jitter_offsets = null;
  window.gravity_offset = null;
  window.dropper_movement_funcs = null;
  window.dropper_movement_func = null;
  window.fractals = null;
  window.fractal = null;
  window.center = null;
  window.last_timestamp = 0;
  window.average_framerate = 0;
  window.target_framerate = 0;
  window.universe = null;
  window.rules = null;

  window.char_height = 24;
  window.half_char_height = window.char_height / 2;
  window.char_width = 12;
  window.frame_count = 0;
  window.index_lists = [];


  /*----------- Animations -----------*/
  window.animations = new ObjectSampler()
    .put("null.js", 0)
    .put("rndfill.js", 1)
    .put("eratosthenes.js", 2)
    .put("knightstour.js", 2)
    .put("textgen.js", 3)
    .put("tenprint.js", 3)
    .put("circ.js", 1)
    .put("tris.js", 1)
    .put("heart.js", 0.1)
    .put("simplex_growth.js", 1.25)
    .put("mapgen.js", 2)
    .put("dvdball.js", 1)
    .put("dog.js", 0.75)
    .put("bresenham_bounce.js", 1.5)
    .put("flow_fields.js", 3)
    .put("clock.js", 1)
    .put("sand.js", 4)
    .put("fractal.js", 4)
    .put("1d_automata.js", 2)
    .put("2d_automata.js", 6)
    .put("langtons_ant.js", 3)
    .put("cyclic_ca.js", 1)
    .put("boids.js", 3)
    .put("gas.js", 3)
    .put("voronoi.js", 3)
    .put("worley.js", 3)
    .put("lissajous.js", 3)
    .put("fluid.js", 3)
    .put("bytebeat.js", 3)
    .put("dla.js", 2)
    .put("physarum.js", 3)
    .put("raster.js", 3);

  /*----------- Random/Seed init -----------*/
  var seed_param = getUrlParameter("c");
  if (!!seed_param) {
    Math.seedrandom(seed_param);
  }

  var animation_index_param = getUrlParameter("a");
  var animation_index = parseInt(animation_index_param, 10);

  var sub_animation_param = getUrlParameter("b");
  window.sub_animation_index = parseInt(sub_animation_param, 10);

  var rule_param = getUrlParameter("rule");
  if (rule_param) {
    window.forced_rule_string = rule_param;
    if (isNaN(animation_index)) {
       // Force 2d_automata.js if rule is present and no specific animation is requested
       // We find the index for 2d_automata.js to be consistent
       var life_idx = window.animations.index_of("2d_automata.js");
       if (life_idx !== -1) {
         animation_index = life_idx;
       }
    }
  }

  var generation_param = getUrlParameter("generation");
  if (generation_param) {
      window.pause_at_generation = parseInt(generation_param, 10);
  }

  window.constant_random_boolean = Math.random() < 0.5;
  window.constant_random_values = [];
  for (var i = 0; i < 20; i++) {
    window.constant_random_values.push(Math.random());
  }

  var animation_file;
  if (!isNaN(animation_index) && animation_index >= 0 && animation_index < window.animations.size()) {
    animation_file = window.animations.get_index(animation_index);
  } else {
    animation_file = window.animations.sample();
  }

  window.animation = animation_file;

  /*----------- on doc ready -----------*/

  $(window).on('load', function() {
    var dark_link = document.getElementById("dark");
    var theme_switch = (should_dark_mode_func) => {
      if (should_dark_mode_func()) {
        document.body.style.background = "black";
        document.body.style.color = "white";
        document.cookie = "theme=dark; SameSite=Strict";
        dark_link.children[0].text = "LIGHT";
      } else {
        document.body.style.background = "white";
        document.body.style.color = "black";
        document.cookie = "theme=light; SameSite=Strict";
        dark_link.children[0].text = "DARK";
      }
    }
    var is_background_white = () => document.body.style.background == "white";

    if (is_background_white()) {
      dark_link.children[0].text = "DARK";
    } else {
      dark_link.children[0].text = "LIGHT";
    }
    var theme_switch_oncall = theme_switch.bind(null, is_background_white)
    dark_link.onclick = theme_switch_oncall;
    dark_link.onkeydown = (event) => {
      switch (event.code) {
        case 'Space':
        case 'Enter':
          theme_switch_oncall();
      }
    };
    theme_switch(() => !document.cookie.split(';').filter(
        (item) => item.includes('theme=light')).length);

    reset_canvas();

    var updateBrubsbyLink = function() {
        var brubsby = $("h1 > a:first").get()[0];
        var a_param = getUrlParameter("a");
        var b_param = getUrlParameter("b");
        var c_param = getUrlParameter("c");
        var rule_param = getUrlParameter("rule");

        var new_a = a_param;
        var new_b = b_param;
        var new_c = c_param;

        var getNum = (val, def) => {
            var p = parseInt(val, 10);
            return isNaN(p) ? def : p;
        };

        if (rule_param) {
            new_c = getNum(c_param, 0) + 1;
        } else if (typeof c_param !== 'undefined') {
            new_c = getNum(c_param, 0) + 1;
        } else if (typeof b_param !== 'undefined') {
            var parsed_b = getNum(b_param, 0);
            var parsed_a = getNum(a_param, 0);
            var sub_size = window.sub_animation_size || 1;
            
            if (parsed_b + 1 >= sub_size) {
                new_a = (parsed_a + 1) % window.animations.size();
                new_b = 0;
            } else {
                new_b = parsed_b + 1;
            }
        } else if (typeof a_param !== 'undefined') {
            var parsed_a = getNum(a_param, 0);
            new_a = (parsed_a + 1) % window.animations.size();
        } else {
            brubsby.href = window.location.pathname;
            return;
        }

        var params = [];
        if (typeof new_a !== 'undefined' && new_a !== null) params.push("a=" + new_a);
        if (typeof new_b !== 'undefined' && new_b !== null) params.push("b=" + new_b);
        if (typeof new_c !== 'undefined' && new_c !== null) params.push("c=" + new_c);
        
        if (rule_param) {
            params.push("rule=" + encodeURIComponent(rule_param));
        }

        var generation_param = getUrlParameter("generation");
        if (generation_param) {
            params.push("generation=" + generation_param);
        }
        
        brubsby.href = "?" + params.join("&");
    };

    import(`./js/animations/${animation_file}`).then(module => {
        const animationFunc = module.default;
        setTimeout(() => {
            animationFunc.call(null, animationFunc);
            updateBrubsbyLink();
        }, 0);
    });
  });
  </script>
  </head>
  <body>
    <div class="container">
      <div class="menu">
        <h1><a href="">BRUBSBY</a></h1>
        <ol id="links">
          <li id="github"><a href="https://github.com/brubsby">GITHUB</a></li>
          <li id="links"><a href="links">LINKS</a></li>
          <li id="cozyvec"><a href="cozyvec">COZYVEC</a></li>
          <li id="randomsiiva"><a href="randomsiiva">RANDOMSIIVA</a></li>
          <li id="dicetodo"><a href="dicetodo">DICETODO</a></li>
          <li id="hamming-web"><a href="hamming-web">HAMMINGWEB</a></li>
          <li id="dark"><a tabindex="0"></a></li>
        </ol>
      </div>
      <div class="tooltip"><span class="tooltip"></span></div>
      <div class="ascii"></div>
    </div>
  </body>
</html>
